@model JollibeeClone.ViewModels.VNPayProcessingViewModel
@{
    ViewData["Title"] = "Đang xử lý thanh toán VNPay";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="~/css/vnpay-processing.css" />

<div class="vnpay-processing-container">
    <div class="processing-content">
        <div class="processing-header">
            <div class="vnpay-logo">
                <img src="~/assets/images/vnpay.png" alt="VNPAY" class="vnpay-logo-img" />
            </div>
            <h1>Đang xử lý thanh toán</h1>
            <p class="order-info">Đơn hàng: <strong>@Model.OrderCode</strong></p>
        </div>

        <div class="processing-animation">
            <div class="spinner"></div>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <div class="processing-steps">
            <div class="step completed">
                <div class="step-icon">
                    <i class="fas fa-check"></i>
                </div>
                <div class="step-text">
                    <h4>Đơn hàng đã được tạo</h4>
                    <p>Mã đơn hàng: @Model.OrderCode</p>
                </div>
            </div>

            <div class="step active">
                <div class="step-icon">
                    <i class="fas fa-credit-card"></i>
                </div>
                <div class="step-text">
                    <h4>Đang chuyển đến VNPay</h4>
                    <p>Vui lòng chờ trong giây lát...</p>
                </div>
            </div>

            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="step-text">
                    <h4>Xác thực thanh toán</h4>
                    <p>Thanh toán bảo mật qua VNPay</p>
                </div>
            </div>

            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="step-text">
                    <h4>Hoàn tất</h4>
                    <p>Xác nhận đơn hàng thành công</p>
                </div>
            </div>
        </div>

        <div class="processing-info">
            <div class="info-box">
                <h3><i class="fas fa-info-circle"></i> Hướng dẫn thanh toán</h3>
                <ul>
                    <li>Bạn sẽ được chuyển đến trang thanh toán VNPay an toàn</li>
                    <li>Chọn ngân hàng và phương thức thanh toán phù hợp</li>
                    <li>Nhập thông tin thẻ/tài khoản theo hướng dẫn</li>
                    <li>Sau khi thanh toán thành công, bạn sẽ được chuyển về trang xác nhận</li>
                </ul>
            </div>

            <div class="security-info">
                <div class="security-badge">
                    <i class="fas fa-lock"></i>
                    <span>Thanh toán bảo mật SSL</span>
                </div>
                <div class="security-badge">
                    <i class="fas fa-shield-alt"></i>
                    <span>Được bảo vệ bởi VNPay</span>
                </div>
            </div>
        </div>

        <div class="processing-actions">
            <a href="@Url.Action("Index", "Home")" class="btn btn-outline">
                <i class="fas fa-home"></i> Về trang chủ
            </a>
            <button type="button" class="btn btn-primary" onclick="window.location.reload()">
                <i class="fas fa-redo"></i> Thử lại
            </button>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    // Auto redirect after 5 seconds if user is still on this page
    setTimeout(function() {
        console.log('Auto redirect timeout - redirecting to home');
        window.location.href = '@Url.Action("Index", "Home")';
    }, 30000); // 30 seconds timeout

    // Update loading animation
    let dotIndex = 0;
    setInterval(function() {
        const dots = $('.loading-dots span');
        dots.removeClass('active');
        dots.eq(dotIndex % 3).addClass('active');
        dotIndex++;
    }, 500);
});
</script> 