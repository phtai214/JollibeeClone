@model JollibeeClone.ViewModels.RegisterViewModel
@{
    ViewData["Title"] = "Đăng Ký Tài Khoản";
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Jollibee</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/auth.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fonts -->
    <link href="https://db.onlinewebfonts.com/c/870c14ea660dc49cbcf9c92af21392af?family=Merge+Black+W00+Regular" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <button type="button" class="close-btn" onclick="window.location.href='@Url.Action("Index", "Home")'" title="Quay lại trang chủ">
                    <i class="fas fa-times"></i>
                </button>
                <h1>ĐĂNG KÝ TÀI KHOẢN</h1>
                <p>Tham gia cùng gia đình Jollibee để nhận nhiều ưu đãi hấp dẫn!</p>
            </div>
            
            <div class="auth-body">
                @if (TempData["ErrorMessage"] != null)
                {
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        @TempData["ErrorMessage"]
                    </div>
                }

                @if (TempData["SuccessMessage"] != null)
                {
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        @TempData["SuccessMessage"]
                    </div>
                }

                <form asp-action="Register" method="post" id="registerForm">
                    @Html.AntiForgeryToken()
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="FullName" class="form-label">
                                    <i class="fas fa-user me-2"></i>@Html.DisplayNameFor(m => m.FullName) *
                                </label>
                                <input asp-for="FullName" class="form-control @(!Html.ViewData.ModelState.ContainsKey("FullName") || Html.ViewData.ModelState["FullName"]!.Errors.Count == 0 ? "" : "is-invalid")" 
                                       placeholder="Nhập họ và tên đầy đủ" />
                                <span asp-validation-for="FullName" class="invalid-feedback"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Email" class="form-label">
                                    <i class="fas fa-envelope me-2"></i>@Html.DisplayNameFor(m => m.Email) *
                                </label>
                                <input asp-for="Email" class="form-control @(!Html.ViewData.ModelState.ContainsKey("Email") || Html.ViewData.ModelState["Email"]!.Errors.Count == 0 ? "" : "is-invalid")" 
                                       placeholder="example@email.com" />
                                <span asp-validation-for="Email" class="invalid-feedback"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="PhoneNumber" class="form-label">
                                    <i class="fas fa-phone me-2"></i>@Html.DisplayNameFor(m => m.PhoneNumber) *
                                </label>
                                <input asp-for="PhoneNumber" class="form-control @(!Html.ViewData.ModelState.ContainsKey("PhoneNumber") || Html.ViewData.ModelState["PhoneNumber"]!.Errors.Count == 0 ? "" : "is-invalid")" 
                                       placeholder="0901234567" />
                                <span asp-validation-for="PhoneNumber" class="invalid-feedback"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="DateOfBirth" class="form-label">
                                    <i class="fas fa-calendar me-2"></i>@Html.DisplayNameFor(m => m.DateOfBirth)
                                </label>
                                <input asp-for="DateOfBirth" type="date" class="form-control" />
                                <span asp-validation-for="DateOfBirth" class="invalid-feedback"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Gender" class="form-label">
                                    <i class="fas fa-venus-mars me-2"></i>@Html.DisplayNameFor(m => m.Gender) *
                                </label>
                                <select asp-for="Gender" class="form-select @(!Html.ViewData.ModelState.ContainsKey("Gender") || Html.ViewData.ModelState["Gender"]!.Errors.Count == 0 ? "" : "is-invalid")">
                                    <option value="">Chọn giới tính</option>
                                    <option value="Nam">Nam</option>
                                    <option value="Nữ">Nữ</option>
                                    <option value="Khác">Khác</option>
                                </select>
                                <span asp-validation-for="Gender" class="invalid-feedback"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="City" class="form-label">
                                    <i class="fas fa-map-marker-alt me-2"></i>@Html.DisplayNameFor(m => m.City) *
                                </label>
                                <select asp-for="City" class="form-select @(!Html.ViewData.ModelState.ContainsKey("City") || Html.ViewData.ModelState["City"]!.Errors.Count == 0 ? "" : "is-invalid")">
                                    <option value="">Chọn thành phố</option>
                                    <option value="Hồ Chí Minh">Hồ Chí Minh</option>
                                    <option value="Hà Nội">Hà Nội</option>
                                    <option value="Đà Nẵng">Đà Nẵng</option>
                                    <option value="Cần Thơ">Cần Thơ</option>
                                    <option value="Hải Phòng">Hải Phòng</option>
                                    <option value="Nha Trang">Nha Trang</option>
                                    <option value="Khác">Khác</option>
                                </select>
                                <span asp-validation-for="City" class="invalid-feedback"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Password" class="form-label">
                                    <i class="fas fa-lock me-2"></i>@Html.DisplayNameFor(m => m.Password) *
                                </label>
                                <input asp-for="Password" type="password" class="form-control @(Html.ViewData.ModelState.IsValidField("Password") ? "" : "is-invalid")" 
                                       placeholder="Ít nhất 6 ký tự" />
                                <span asp-validation-for="Password" class="invalid-feedback"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="ConfirmPassword" class="form-label">
                                    <i class="fas fa-lock me-2"></i>@Html.DisplayNameFor(m => m.ConfirmPassword) *
                                </label>
                                <input asp-for="ConfirmPassword" type="password" class="form-control @(Html.ViewData.ModelState.IsValidField("ConfirmPassword") ? "" : "is-invalid")" 
                                       placeholder="Nhập lại mật khẩu" />
                                <span asp-validation-for="ConfirmPassword" class="invalid-feedback"></span>
                            </div>
                        </div>
                    </div>

                    <div class="form-check">
                        <input asp-for="AcceptPolicy" class="form-check-input @(Html.ViewData.ModelState.IsValidField("AcceptPolicy") ? "" : "is-invalid")" 
                               type="checkbox" id="acceptPolicy" />
                        <label class="form-check-label" for="acceptPolicy">
                            Đồng ý với <a href="#" class="text-danger">Chính sách và quy định chung</a> và 
                            <a href="#" class="text-danger">Thông báo bảo mật thông tin</a> của Jollibee *
                        </label>
                        <span asp-validation-for="AcceptPolicy" class="invalid-feedback d-block"></span>
                    </div>

                    <div class="form-check">
                        <input asp-for="ReceivePromotions" class="form-check-input" type="checkbox" id="receivePromotions" />
                        <label class="form-check-label" for="receivePromotions">
                            Nhận thông tin khuyến mãi qua email và SMS
                        </label>
                    </div>

                    <button type="submit" class="btn btn-jollibee mt-4" id="submitBtn">
                        <i class="fas fa-user-plus me-2"></i>
                        ĐĂNG KÝ
                    </button>

                    <div class="auth-links">
                        <p>Đã có tài khoản? <a asp-action="Login">Đăng nhập ngay</a></p>
                        <p><a asp-controller="Home" asp-action="Index">← Quay lại trang chủ</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/jquery.validate.min.js"></script>
    <script src="~/js/jquery.validate.unobtrusive.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // Form submission với loading state
            $('#registerForm').on('submit', function() {
                var submitBtn = $('#submitBtn');
                submitBtn.prop('disabled', true);
                submitBtn.addClass('loading');
                submitBtn.html('<i class="fas fa-spinner fa-spin me-2"></i>Đang xử lý...');
            });

            // Password strength indicator
            $('#Password').on('input', function() {
                var password = $(this).val();
                var strength = 0;
                
                if (password.length >= 6) strength += 1;
                if (password.match(/[a-z]/)) strength += 1;
                if (password.match(/[A-Z]/)) strength += 1;
                if (password.match(/[0-9]/)) strength += 1;
                if (password.match(/[^a-zA-Z0-9]/)) strength += 1;
                
                var strengthText = '';
                var strengthClass = '';
                
                switch(strength) {
                    case 0:
                    case 1:
                        strengthText = 'Yếu';
                        strengthClass = 'text-danger';
                        break;
                    case 2:
                    case 3:
                        strengthText = 'Trung bình';
                        strengthClass = 'text-warning';
                        break;
                    case 4:
                    case 5:
                        strengthText = 'Mạnh';
                        strengthClass = 'text-success';
                        break;
                }
                
                $('#passwordStrength').remove();
                if (password.length > 0) {
                    $(this).after('<small id="passwordStrength" class="' + strengthClass + '">Độ mạnh mật khẩu: ' + strengthText + '</small>');
                }
            });
            
            // Form validation enhancement
            $.validator.addMethod("phoneVN", function(value, element) {
                return this.optional(element) || /^(0[3|5|7|8|9])+([0-9]{8})$/.test(value);
            }, "Số điện thoại không hợp lệ");
            
            $("#registerForm").validate({
                rules: {
                    PhoneNumber: {
                        phoneVN: true
                    }
                }
            });
        });
    </script>
</body>
</html> 