@model JollibeeClone.Models.Product

@{
    ViewData["Title"] = "Xóa sản phẩm";
}

@section Styles {
    <link rel="stylesheet" href="~/css/product-admin.css" asp-append-version="true" />
}

<div class="delete-product">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="page-title">
                <i class="fas fa-trash text-danger me-2"></i>
                Xóa sản phẩm
            </h2>
            <p class="text-muted">Xác nhận xóa sản phẩm: <strong class="text-danger">@Model.ProductName</strong></p>
        </div>
        <a href="@Url.Action("Index")" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>
            Quay lại danh sách
        </a>
    </div>

    <!-- Cáº£nh bÃ¡o -->
    <div class="alert alert-danger" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>
        <strong>Cáº£nh bÃ¡o!</strong> HÃ nh Ä‘á»™ng nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c. Sáº£n pháº©m sáº½ bá»‹ xÃ³a vÄ©nh viá»…n khá»i há»‡ thá»‘ng.
    </div>

    <!-- ThÃ´ng tin sáº£n pháº©m sáº½ bá»‹ xÃ³a -->
    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-info-circle me-2"></i>
                        Thông tin sản phẩm sẽ bị xóa
                    </h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-3">ID sản phẩm:</dt>
                        <dd class="col-sm-9">@Html.DisplayFor(model => model.ProductID)</dd>

                        <dt class="col-sm-3">Tên sản phẩm:</dt>
                        <dd class="col-sm-9">@Html.DisplayFor(model => model.ProductName)</dd>

                        @if (!string.IsNullOrEmpty(Model.ShortDescription))
                        {
                            <dt class="col-sm-3">Mô tả:</dt>
                            <dd class="col-sm-9">@Html.DisplayFor(model => model.ShortDescription)</dd>
                        }

                        <dt class="col-sm-3">Giá bán:</dt>
                        <dd class="col-sm-9">
                            <span class="fw-bold text-success">@Model.Price.ToString("C0", new System.Globalization.CultureInfo("vi-VN"))</span>
                            @if (Model.OriginalPrice.HasValue && Model.OriginalPrice > Model.Price)
                            {
                                <small class="text-muted ms-2">
                                    <s>@Model.OriginalPrice.Value.ToString("C0", new System.Globalization.CultureInfo("vi-VN"))</s>
                                </small>
                            }
                        </dd>

                        <dt class="col-sm-3">Danh mục:</dt>
                        <dd class="col-sm-9">
                            @if (Model.Category != null)
                            {
                                <span class="badge bg-secondary">@Html.DisplayFor(model => model.Category.CategoryName)</span>
                            }
                            else
                            {
                                <span class="text-muted">Chưa phân loại</span>
                            }
                        </dd>

                        <dt class="col-sm-3">Tùy chỉnh:</dt>
                        <dd class="col-sm-9">
                            @if (Model.IsConfigurable)
                            {
                                <span class="badge bg-info">
                                    <i class="fas fa-cogs me-1"></i>
                                    Có thể tùy chỉnh
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">Không tùy chỉnh</span>
                            }
                        </dd>

                        <dt class="col-sm-3">Trạng thái:</dt>
                        <dd class="col-sm-9">
                            @if (Model.IsAvailable)
                            {
                                <span class="badge bg-success">
                                    <i class="fas fa-check me-1"></i>
                                    Có sẵn
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-warning">
                                    <i class="fas fa-exclamation me-1"></i>
                                    Hết hàng
                                </span>
                            }
                        </dd>
                    </dl>

                    <hr>

                    <!-- Form xác nhận xóa -->
                    <form asp-action="Delete" method="post">
                        <input asp-for="ProductID" type="hidden" />
                        @Html.AntiForgeryToken()
                        
                        <div class="delete-confirmation mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="confirmDelete" required>
                                <label class="form-check-label" for="confirmDelete">
                                    Tôi hiểu rằng hành động này không thể hoàn tác và đồng ý xóa sản phẩm này.
                                </label>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-danger btn-lg" id="deleteBtn" disabled>
                                <i class="fas fa-trash me-2"></i>
                                Xác nhận xóa sản phẩm
                            </button>
                            <a href="@Url.Action("Index")" class="btn btn-secondary btn-lg">
                                <i class="fas fa-times me-2"></i>
                                Hủy
                            </a>
                            <a href="@Url.Action("Edit", new { id = Model.ProductID })" class="btn btn-warning btn-lg">
                                <i class="fas fa-edit me-2"></i>
                                Chỉnh sửa thay vì xóa
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <!-- áº¢nh sáº£n pháº©m -->
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-image me-2"></i>
                        Hình ảnh sản phẩm
                    </h5>
                </div>
                <div class="card-body text-center">
                    @if (!string.IsNullOrEmpty(Model.ImageUrl))
                    {
                        <img src="@Model.ImageUrl" alt="@Model.ProductName" class="img-fluid rounded shadow-sm" style="max-height: 250px;" />
                    }
                    else
                    {
                        <div class="no-image">
                            <i class="fas fa-hamburger" style="font-size: 4rem; color: #ddd;"></i>
                            <p class="text-muted mt-2">Không có ảnh</p>
                        </div>
                    }
                </div>
            </div>

            <!-- Cáº£nh bÃ¡o liÃªn quan -->
            <div class="card mt-4">
                <div class="card-header bg-warning text-dark">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Lưu ý quan trọng
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="mb-0">
                        <li>Sáº£n pháº©m sáº½ bá»‹ xÃ³a vÄ©nh viá»…n khá»i há»‡ thá»‘ng</li>
                        <li>HÃ¬nh áº£nh liÃªn quan cÅ©ng sáº½ bá»‹ xÃ³a</li>
                        <li>Náº¿u sáº£n pháº©m Ä‘Ã£ cÃ³ trong Ä‘Æ¡n hÃ ng, khÃ´ng thá»ƒ xÃ³a</li>
                        <li>ThÃ´ng tin thá»‘ng kÃª sáº½ bá»‹ áº£nh hÆ°á»Ÿng</li>
                        <li>HÃ nh Ä‘á»™ng nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c</li>
                    </ul>
                </div>
            </div>

            <!-- Gá»£i Ã½ thay tháº¿ -->
            <div class="card mt-4">
                <div class="card-header bg-info text-white">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-lightbulb me-2"></i>
                        Gá»£i Ã½ thay tháº¿
                    </h5>
                </div>
                <div class="card-body">
                    <p><strong>Thay vÃ¬ xÃ³a, báº¡n cÃ³ thá»ƒ:</strong></p>
                    <ul class="mb-0">
                        <li>Äáº·t sáº£n pháº©m á»Ÿ tráº¡ng thÃ¡i "Háº¿t hÃ ng"</li>
                        <li>Chá»‰nh sá»­a thÃ´ng tin Ä‘á»ƒ cáº­p nháº­t</li>
                        <li>Chuyá»ƒn sang danh má»¥c khÃ¡c</li>
                        <li>Táº¡m thá»i áº©n khá»i khÃ¡ch hÃ ng</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
$(document).ready(function() {
    // Enable/disable delete button based on confirmation checkbox
    $('#confirmDelete').on('change', function() {
        $('#deleteBtn').prop('disabled', !this.checked);
    });

    // Confirmation before actual deletion
    $('form').on('submit', function(e) {
        if (!$('#confirmDelete').is(':checked')) {
            e.preventDefault();
            alert('Vui lÃ²ng xÃ¡c nháº­n báº±ng cÃ¡ch Ä‘Ã¡nh dáº¥u vÃ o Ã´ checkbox!');
            return false;
        }

        var confirmed = confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a sáº£n pháº©m "' + '@Model.ProductName' + '"?\n\nHÃ nh Ä‘á»™ng nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c!');
        if (!confirmed) {
            e.preventDefault();
            return false;
        }

        // Show loading state
        var submitBtn = $('#deleteBtn');
        var originalText = submitBtn.html();
        submitBtn.prop('disabled', true).html('<i class="fas fa-spinner fa-spin me-2"></i>Äang xÃ³a...');
        
        // Don't reset on timeout since this is deletion
    });
});
</script>
} 

