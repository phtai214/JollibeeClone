@model JollibeeClone.Areas.Admin.Models.Service

@{
    ViewData["Title"] = "Thêm dịch vụ mới";
}

<div class="service-create">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="page-title">
                <i class="fas fa-plus text-jollibee-red me-2"></i>
                Thêm dịch vụ mới
            </h2>
            <p class="text-muted">Tạo dịch vụ mới cho cửa hàng</p>
        </div>
        <div class="header-actions">
            <a href="@Url.Action("Index")" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>
                Quay lại danh sách
            </a>
        </div>
    </div>

    <form asp-action="Create" method="post" enctype="multipart/form-data" id="serviceForm">
        <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
        
        <div class="row">
            <!-- Form chính -->
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-edit me-2"></i>
                            Thông tin dịch vụ
                        </h5>
                    </div>
                    <div class="card-body">
                        <!-- Tên dịch vụ -->
                        <div class="mb-3">
                            <label asp-for="ServiceName" class="form-label required">Tên dịch vụ</label>
                            <input asp-for="ServiceName" class="form-control" placeholder="Nhập tên dịch vụ..." />
                            <span asp-validation-for="ServiceName" class="text-danger"></span>
                        </div>

                        <!-- Mô tả ngắn -->
                        <div class="mb-3">
                            <label asp-for="ShortDescription" class="form-label">Mô tả ngắn</label>
                            <textarea asp-for="ShortDescription" class="form-control" rows="3" placeholder="Nhập mô tả ngắn (tối đa 500 ký tự)..."></textarea>
                            <span asp-validation-for="ShortDescription" class="text-danger"></span>
                            <div class="form-text">Mô tả ngắn sẽ hiển thị trong danh sách dịch vụ</div>
                        </div>

                        <!-- Nội dung -->
                        <div class="mb-3">
                            <label asp-for="Content" class="form-label">Nội dung chi tiết</label>
                            <textarea asp-for="Content" class="form-control" rows="8" placeholder="Nhập nội dung chi tiết về dịch vụ..."></textarea>
                            <span asp-validation-for="Content" class="text-danger"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Upload ảnh -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h6 class="card-title mb-0">
                            <i class="fas fa-image me-2"></i>
                            Hình ảnh dịch vụ
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="image-upload-section">
                            <div class="file-upload-area" id="fileUploadArea">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p><strong>Kéo thả ảnh vào đây</strong></p>
                                <p>hoặc</p>
                                <label for="imageFile" class="btn btn-outline-primary">
                                    <i class="fas fa-folder-open me-2"></i>
                                    Chọn file từ máy
                                </label>
                                <input asp-for="ImageFile" type="file" id="imageFile" accept="image/*" style="display: none;" />
                            </div>
                            
                            <div id="imagePreview" class="image-preview" style="display: none;">
                                <img id="previewImg" src="#" alt="Preview" />
                                <div class="image-actions">
                                    <button type="button" class="btn btn-sm btn-danger" id="removeImage">
                                        <i class="fas fa-trash"></i>
                                        Xóa ảnh
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="upload-guidelines">
                            <h6><i class="fas fa-info-circle me-2"></i>Hướng dẫn upload ảnh:</h6>
                            <ul>
                                <li>Kích thước tối đa: 5MB</li>
                                <li>Định dạng: JPG, PNG, GIF, WEBP</li>
                                <li>Kích thước khuyến nghị: 600x400px</li>
                                <li>Ảnh chất lượng cao để thu hút khách hàng</li>
                            </ul>
                        </div>
                        <span asp-validation-for="ImageFile" class="text-danger"></span>
                    </div>
                </div>

                <!-- Thiết lập -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h6 class="card-title mb-0">
                            <i class="fas fa-cog me-2"></i>
                            Thiết lập
                        </h6>
                    </div>
                    <div class="card-body">
                        <!-- Thứ tự hiển thị -->
                        <div class="mb-3">
                            <label asp-for="DisplayOrder" class="form-label">Thứ tự hiển thị</label>
                            <input asp-for="DisplayOrder" type="number" class="form-control" min="0" placeholder="0" />
                            <span asp-validation-for="DisplayOrder" class="text-danger"></span>
                            <div class="form-text">
                                Số thứ tự để sắp xếp dịch vụ (0 = hiển thị đầu tiên)
                            </div>
                        </div>

                        <!-- Trạng thái hoạt động -->
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input asp-for="IsActive" type="checkbox" class="form-check-input" id="isActive" checked />
                                <label class="form-check-label" for="isActive">
                                    <i class="fas fa-toggle-on me-2"></i>
                                    Kích hoạt dịch vụ
                                </label>
                            </div>
                            <div class="form-text">
                                Dịch vụ chỉ hiển thị khi được kích hoạt
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Nút lưu -->
                <div class="card">
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-save me-2"></i>
                                Lưu dịch vụ
                            </button>
                            <a href="@Url.Action("Index")" class="btn btn-outline-secondary">
                                <i class="fas fa-times me-2"></i>
                                Hủy bỏ
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    
    <script>
        $(document).ready(function() {
            // Image preview
            $('#imageFile').change(function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        $('#imagePreviewImg').attr('src', e.target.result).show();
                        $('.upload-placeholder').hide();
                    };
                    reader.readAsDataURL(file);
                } else {
                    $('#imagePreviewImg').hide();
                    $('.upload-placeholder').show();
                }
            });

            // Form validation
            $('#serviceForm').submit(function(e) {
                let isValid = true;
                
                // Check service name
                if (!$('#ServiceName').val().trim()) {
                    isValid = false;
                    $('#ServiceName').addClass('is-invalid');
                } else {
                    $('#ServiceName').removeClass('is-invalid');
                }
                
                if (!isValid) {
                    e.preventDefault();
                    $('html, body').animate({
                        scrollTop: $('.is-invalid').first().offset().top - 100
                    }, 500);
                }
            });
        });
    </script>
}

@section Styles {
    <style>
        .image-upload-section {
            text-align: center;
        }
        
        .image-preview {
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .upload-placeholder {
            text-align: center;
        }
        
        .required::after {
            content: " *";
            color: #dc3545;
        }
    </style>
} 